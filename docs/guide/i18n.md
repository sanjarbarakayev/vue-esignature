# Internationalization (i18n)

Vue E-Signature includes built-in support for multiple languages. Error messages can be displayed in English, Russian, or Uzbek.

## Supported Languages

| Code | Language |
|------|----------|
| `en` | English |
| `ru` | Russian (Русский) |
| `uz` | Uzbek (O'zbek) |

## Setting the Locale

### Global Locale

Set the locale globally for all error messages:

```ts
import { setLocale, getLocale } from '@eimzo/vue'

// Set to Uzbek
setLocale('uz')

// Get current locale
console.log(getLocale()) // 'uz'
```

### Per-Message Locale

Override the locale for a specific message:

```ts
import { getErrorMessage } from '@eimzo/vue'

// Use current global locale
const message1 = getErrorMessage('WRONG_PASSWORD')

// Force specific locale
const message2 = getErrorMessage('WRONG_PASSWORD', 'ru')
console.log(message2) // "Пароль неверный."
```

## Auto-Detect Browser Locale

Automatically detect and set the user's browser locale:

```ts
import { detectAndSetBrowserLocale } from '@eimzo/vue'

// Detects browser language and sets if supported
const detectedLocale = detectAndSetBrowserLocale()
console.log('Using locale:', detectedLocale)
```

## Available Error Messages

| Key | English |
|-----|---------|
| `ERIIMZO_NOT_INSTALLED` | E-IMZO application is not installed... |
| `ERIIMZO_CRYPTO_API_ERROR` | Crypto API error... |
| `ERIIMZO_CERT_NOT_FOUND` | Certificate not found... |
| `ERIIMZO_WRONG_PASSWORD` | Incorrect password... |
| `ERIIMZO_NO_READER` | No card reader found... |
| `ERIIMZO_CARD_NOT_FOUND` | Smart card not found... |
| `CAPIWS_CONNECTION` | Connection error with E-IMZO... |
| `BROWSER_WS` | Browser does not support WebSocket... |
| `UPDATE_APP` | Please install the new version... |
| `WRONG_PASSWORD` | Incorrect password. |
| `VERSION_UNDEFINED` | E-IMZO version is undefined. |
| `INSTALL_NEW_VERSION` | Please install the new version of E-IMZO. |
| `SIGNING_ERROR` | Error during document signing... |
| `KEY_LOAD_ERROR` | Error loading the signing key... |
| `CERTIFICATE_EXPIRED` | Your certificate has expired... |
| `CERTIFICATE_NOT_YET_VALID` | Your certificate is not yet valid... |

## Vue Integration

### Plugin with Locale

```ts
// main.ts
import { createApp } from 'vue'
import { VueESignature, setLocale } from '@eimzo/vue'
import App from './App.vue'

// Set locale before plugin registration
setLocale('uz')

const app = createApp(App)
app.use(VueESignature)
app.mount('#app')
```

### Composable with Locale

```vue
<script setup lang="ts">
import { onMounted } from 'vue'
import {
  useESignature,
  setLocale,
  detectAndSetBrowserLocale
} from '@eimzo/vue'

// Auto-detect on mount
onMounted(() => {
  detectAndSetBrowserLocale()
})

const { install, error } = useESignature()

// error.value will contain localized messages
</script>

<template>
  <div v-if="error" class="error">
    {{ error.message }}
  </div>
</template>
```

### Language Switcher Component

```vue
<script setup lang="ts">
import { ref, watch } from 'vue'
import {
  setLocale,
  getLocale,
  getSupportedLocales,
  type SupportedLocale
} from '@eimzo/vue'

const currentLocale = ref<SupportedLocale>(getLocale())
const locales = getSupportedLocales()

const localeLabels: Record<SupportedLocale, string> = {
  en: 'English',
  ru: 'Русский',
  uz: "O'zbek"
}

watch(currentLocale, (newLocale) => {
  setLocale(newLocale)
})
</script>

<template>
  <div class="language-switcher">
    <label for="locale">Language:</label>
    <select id="locale" v-model="currentLocale">
      <option
        v-for="locale in locales"
        :key="locale"
        :value="locale"
      >
        {{ localeLabels[locale] }}
      </option>
    </select>
  </div>
</template>
```

## Using with Vue I18n

Integrate with Vue I18n for a unified localization experience:

```ts
// i18n.ts
import { createI18n } from 'vue-i18n'
import { setLocale as setESignatureLocale } from '@eimzo/vue'

const i18n = createI18n({
  locale: 'en',
  messages: {
    en: { /* your messages */ },
    ru: { /* your messages */ },
    uz: { /* your messages */ }
  }
})

// Sync locales
export function setAppLocale(locale: 'en' | 'ru' | 'uz') {
  i18n.global.locale = locale
  setESignatureLocale(locale)
}

export default i18n
```

## Error Handling with i18n

```ts
import { getErrorMessage, type ErrorMessageKey } from '@eimzo/vue'

function handleError(error: unknown) {
  const errorMessage = (error as Error).message

  // Map common errors to i18n keys
  const errorKeyMap: Record<string, ErrorMessageKey> = {
    'BadPaddingException': 'WRONG_PASSWORD',
    'WebSocket': 'BROWSER_WS',
    'connection': 'CAPIWS_CONNECTION'
  }

  for (const [pattern, key] of Object.entries(errorKeyMap)) {
    if (errorMessage.includes(pattern)) {
      return getErrorMessage(key)
    }
  }

  // Return original message if no match
  return errorMessage
}
```

## Checking Locale Support

```ts
import { isLocaleSupported, getSupportedLocales } from '@eimzo/vue'

// Check if a locale is supported
if (isLocaleSupported('uz')) {
  setLocale('uz')
}

// Get all supported locales
const locales = getSupportedLocales() // ['en', 'ru', 'uz']
```

## i18n Utility Object

All i18n functions are also available through a convenience object:

```ts
import { i18n } from '@eimzo/vue'

i18n.setLocale('ru')
i18n.getLocale() // 'ru'
i18n.getErrorMessage('WRONG_PASSWORD') // "Пароль неверный."
i18n.getSupportedLocales() // ['en', 'ru', 'uz']
i18n.isLocaleSupported('fr') // false
i18n.detectAndSetBrowserLocale() // Sets based on browser
```

## Best Practices

1. **Set locale early** - Configure the locale before any E-IMZO operations
2. **Sync with app locale** - Keep E-Signature locale in sync with your app's i18n
3. **Test all locales** - Verify error messages display correctly in all languages
4. **Provide fallback** - English is used as fallback for missing translations

## Next Steps

- [Error Handling](/guide/error-handling) - Comprehensive error handling
- [TypeScript Support](/guide/typescript) - Type-safe development
